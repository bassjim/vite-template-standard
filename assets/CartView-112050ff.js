import{_ as x,o as c,c as l,a as u,d as t,F as p,e as f,f as _,t as d,g as b,v as I}from"./index-be3247e0.js";const{VITE_URL:r,VITE_PATH:i}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"bassjim",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},$={data(){return{products:[],itemId:"",product:{},cart:{},loadingItem:"",isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getProducts(){this.$http.get(`${r}/api/${i}/products/all`).then(e=>{this.products=e.data.products,this.isLoading=!1}).catch(e=>{console.log(e)})},openModal(e){this.itemId=e},getCarts(){this.$http.get(`${r}/api/${i}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{console.log(e)})},updateCartItem(e){const n={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id;const g=`${r}/api/${i}/cart/${e.id}`;this.$http.put(`${g}`,{data:n}).then(h=>{this.cart=h.data.data,this.getCarts(),this.loadingItem=""}).catch(h=>{console.log(h)})},deleteItem(e){this.loadingItem=e,this.$http.delete(`${r}api/${i}/cart/${e}`).then(n=>{this.getCarts(),this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},300)}).catch(n=>{console.log(n)})},isPhone(e){return/^(09)[0-9]{8}$/.test(e)?!0:"需要正確的電話號碼"},createOrder(){this.$http.post(`${r}/api/${i}/order`,{data:this.form}).then(e=>{alert(e.data.message),this.getCarts(),this.$refs.form.resetForm(),this.clearCart("")}).catch(e=>{console.log(e)})}},mounted(){this.getCarts()}},C={class:"table align-middle"},y=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),v=["disabled","onClick"],V={key:0,class:"fas fa-spinner fa-pulse"},k=t("div",{class:"text-success"}," 已套用優惠券 ",-1),L={class:"input-group input-group-sm"},E=["onUpdate:modelValue","disabled","onChange"],T=["value"],D={class:"input-group-text",id:"basic-addon2"},N={class:"text-end"},P=t("small",{class:"text-success"},"折扣價：",-1),U=t("td",{colspan:"3",class:"text-end"},"總計",-1),q={class:"text-end"},B={key:0},R=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),w={class:"text-end text-success"};function A(e,n,g,h,o,m){return c(),l(p,null,[u(" 購物車 "),t("table",C,[y,t("tbody",null,[o.cart.carts?(c(!0),l(p,{key:0},f(o.cart.carts,s=>(c(),l("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===o.loadingItem,onClick:a=>m.deleteItem(s.id)},[o.isLoading?(c(),l("i",V)):_("",!0),u(" x ")],8,v)]),t("td",null,[u(d(s.product.title)+" ",1),k]),t("td",null,[t("div",L,[b(t("select",{class:"form-select","onUpdate:modelValue":a=>s.qty=a,disabled:s.id===o.loadingItem,onChange:a=>m.updateCartItem(s)},[(c(),l(p,null,f(20,a=>t("option",{value:a,key:a+"123456"},d(a),9,T)),64))],40,E),[[I,s.qty]]),t("span",D,d(s.product.unit),1)])]),t("td",N,[P,u(" "+d(s.total),1)])]))),128)):_("",!0)]),t("tfoot",null,[t("tr",null,[U,t("td",q,d(o.cart.total),1)]),o.cart.final_total!==o.cart.total?(c(),l("tr",B,[R,t("td",w,d(o.cart.final_total),1)])):_("",!0)])])],64)}const M=x($,[["render",A]]);export{M as default};
